{{template "base" .}}

{{define "title"}}My Files{{end}}

{{define "body"}}
<article>
    <div id="content">
        <h1 class="title">My Files</h1>
        <div class="post-content">
            <div class="files">
                {{if .Files}}
                {{range .Files}}
                <div class="file" data-file-url="{{.URL}}">
                    <p>{{ .Name}}</p>
                </div>
                {{end}}
                {{end}}
            </div>
            <form id="form" class="topBefore" enctype="multipart/form-data" action="/files" method="post" novalidate>
                <!-- Include the CSRF token -->
                <input type="hidden" name="csrf_token" value='{{.CSRFToken}}'>
                <div>
                    <label class="input-file">
                        <input id="file" type="file" name="file">
                        <span>Сhoice File</span>
                    </label>
                </div>
                <div>
                    <input id="submit" type="submit" value="Upload">
                </div>
            </form>
        </div>
    </div>
</article>
{{end}}

<script>
    // Функция для скачивания файла по URL
    function downloadFile(url) {
        const link = document.createElement('a');
        link.href = url;
        link.download = url.split('/').pop(); // Получить имя файла из URL
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }

    // Обработчик события при наведении курсора
    document.addEventListener('mouseover', function (e) {
        if (e.target && e.target.classList.contains('file')) {
            const fileUrl = e.target.getAttribute('data-file-url');
            e.target.style.cursor = 'pointer'; // Изменить курсор при наведении
            e.target.addEventListener('click', function () {
                downloadFile(fileUrl);
            });
        }
    });
</script>